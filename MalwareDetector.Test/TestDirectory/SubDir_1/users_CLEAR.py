import hashlib

from classes.base import BaseDataItem


class User(BaseDataItem):
    def __init__(self):
        BaseDataItem.__init__(self)
        self.first_name = ''
        self.last_name = ''
        self.second_name = ''
        self.password = ''
        self.email = ''
        self.auth_token = ''
        self.refresh_token = ''
        self.roles = []

    @classmethod
    def pwd_hash(cls, s):
        hashlib.md5(s.encode('utf-8')).hexdigest()

    def tojobj(self):
        return {"first_name":self.first_name,"last_name":self.last_name,"second_name":self.second_name,"email":self.email, "id":str(self.id)}


class Role(BaseDataItem):
    def __init__(self):
        BaseDataItem.__init__(self)
        self.name = ''

    def tojobj(self):
        return {"name":self.name, "id":str(self.id)}


class Group(BaseDataItem):
    def __init__(self):
        BaseDataItem.__init__(self)
        self.name = ''
        self.users = []
    
    def tojobj(self):
        return {"name":self.name, "id":str(self.id)}
