using Microsoft.VisualStudio.TestTools.UnitTesting;
using MalwareDetector.BusinessLogic;

namespace MalwareDetector.Test
{
    [TestClass]
    public class ReportTest
    {
        private static ScanRule[] scanRules = new[] {
                new ScanRule("JS", "<script>evil_script()</script>", ".js"),
                new ScanRule("rm -rf", @"rm -rf %userprofile%\Documents"),
                new ScanRule("Rundll32", "Rundll32 sus.dll SusEntry")
            };
        private static ScanReport result = new ScanService(@"C:\Users\wwwdi\Desktop\TestDirectory", scanRules).Run();


        [TestMethod]
        public void ReportAmountTest()
        {
            Assert.AreEqual(result.GetAmount(), 18);
        }
        [TestMethod]
        public void ReportAmountJS()
        {
            Assert.AreEqual(result.GetAmountByRule(scanRules[0]), 1);
        }
        [TestMethod]
        public void ReportAmountRM_RF()
        {
            Assert.AreEqual(result.GetAmountByRule(scanRules[1]), 1);
        }
        [TestMethod]
        public void ReportAmountTestRundll32()
        {
            Assert.AreEqual(result.GetAmountByRule(scanRules[2]), 3);
        }
        [TestMethod]
        public void ReportAmountError()
        {
            Assert.AreEqual(result.GetAmountByType(FileReportType.Error), 0);
        }
        [TestMethod]
        public void ReportAmountMalware()
        {
            Assert.AreEqual(result.GetAmountByType(FileReportType.Malware), 5);
        }
        [TestMethod]
        public void ReportAmountClear()
        {
            Assert.AreEqual(result.GetAmountByType(FileReportType.Clear), 13);
        }
    }
}