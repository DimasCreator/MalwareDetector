using System.Collections.Concurrent;
using System.IO;
using MalwareDetector.BusinessLogic;

namespace MalwareDetector.Service.Server
{
    /// <summary>
    /// Глобальные свойства проекта.
    /// Singleton.
    /// </summary>
    public class GlobalProperties
    {
        /// <summary>
        /// Путь к директории процессов.
        /// </summary>
        public readonly string ProcessDirectoryPath = Path.Combine(Directory.GetCurrentDirectory(), "Process");

        /// <summary>
        /// Список правил по которым сервис производит сканирование.
        /// </summary>
        public readonly ScanRule[] scanRules = new[] {
                new ScanRule("JS", "<script>evil_script()</script>", ".js"),
                new ScanRule("rm -rf", @"rm -rf %userprofile%\Documents"),
                new ScanRule("Rundll32", "Rundll32 sus.dll SusEntry")
            };

        /// <summary>
        /// Настоящий инстанс.
        /// </summary>
        private static GlobalProperties _instance;

        /// <summary>
        /// Доступ к инстансу.
        /// </summary>
        public static GlobalProperties Instance
        {
            get
            {
                return _instance ??= new GlobalProperties();
            }
        }

        /// <summary>
        /// Скрытый конструктор.
        /// </summary>
        private GlobalProperties()
        {
            if (!Directory.Exists(ProcessDirectoryPath))
            {
                Directory.CreateDirectory(ProcessDirectoryPath);
            }
        }
    }
}
