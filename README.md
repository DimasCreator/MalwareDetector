# Тестовое задание Лаборатории Касперского (Усложненная версия задания) в рамках отбора на Safeboard 

Задание:  
  Требуется реализовать два приложения, используя .NET Core / .NET: 
  
  1. Сервисное приложение, реализующее простой REST API, который предоставляет ресурс для создания задач на сканирование файлов в директории и получения статуса задачи по идентификатору
2. Утилиту, работающую из командной строки, отправляющую сервисному приложению команды на создание и просмотр состояния задач.
  
  
В рамках задачи определено 3 типа "подозрительного" содержимого в файле:  
  * Файл с расширением .js, содержащий строку <script>evil_script()</script>  
  * Любой файл, содержащий строку: rm -rf %userprofile%\Documents  
  * Любой файл, содержащий строку: Rundll32 sus.dll SusEntry
  
После завершения команды просмотра статуса задачи может быть выведено два результата: статус "задача еще выполняется" или отчет о сканировании, в котором присутствует следующая информация:
* Путь к директории, сканирование которой производилось
* Общее количество обработанных файлов  
* Количество обнаружений на каждый тип "подозрительного" содержимого  
* Количество ошибок анализа файлов (например, не хватает прав на чтение файла)  
* Время выполнения утилиты.
  
Пример исполнения утилиты из командной строки:  
  scan_util %userprofile%\Documents  
  ====== Scan result ======  
  Processed files: 150  
  JS detects: 5  
  rm -rf detects: 1  
  Rundll32 detects: 2  
  Errors: 1  
  Exection time: 00:00:31  
  
Примечание:  
* Сервисное приложение не имеет постоянного хранилища состояния (каждый запуск как чистый лист)
* В каждом файле может присутствовать только один тип "подозрительного" содержимого
* Сервисное приложение и утилита работают на одном и том же устройстве
* Рекомендуется максимальное использования (утилизация) вычислительных ресурсов устройства, на котором выполняется утилита.
  
## ОПИСАНИЕ РЕШЕНИЯ

MalwareDetector.BusinessLogic - Библиотека классов .Net, содержит логику решения  
MalwareDetector.Program.Cmd - Консольное приложение .Net5, работающее с библиотекой логики  
MalwareDetector.Test - Проект с Unit тестами  
MalwareDetector.Service.Server - Сервер, предоставляющий ресурс для сканирования файлов. Прослушивает https://localhost:5001, при тесте на разных компьютерах возникала проблема, что сервер запускался и прослушивал http://localhost:5000/api/Scan, решить ее пока не удалось.  
MalwareDetector.Service.Client - Клиент веб сервиса
В MalwareDetector.Test присутствует директория TestDirecrory, содержащая файлы для тестирования.
