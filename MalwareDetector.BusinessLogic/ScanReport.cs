using System;
using System.Collections.Concurrent;
using System.Linq;

namespace MalwareDetector.BusinessLogic
{
    /// <summary>
    /// Отчет о сканировании директории
    /// </summary>
    public class ScanReport
    {
        private ConcurrentBag<FileReport> _fileReports = new ConcurrentBag<FileReport>();
        private DateTime? _startTime;
        private DateTime? _endTime;

        public void AddFileReport(FileReport fileReport)
        {
            _fileReports.Add(fileReport);
        }

        public int GetAmountByType(FileReportType type)
        {
            return _fileReports.Where(report => report.ReportType == type).Count();
        }

        public int GetAmountByRule(ScanRule rule)
        {
            return _fileReports.Where(report => report.Rule == rule).Count();
        }

        public int GetAmount()
        {
            return _fileReports.Count;
        }

        public void StartScanning()
        {
            _startTime ??= DateTime.Now;
        }

        public void EndScanning()
        {
            _endTime ??= DateTime.Now;
        }

        public TimeSpan? GetScanningTime()
        {
            _endTime ??= DateTime.Now;
            return _endTime - _startTime;
        }
    }
}
