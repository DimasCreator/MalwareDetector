using System.IO;

namespace MalwareDetector.BusinessLogic
{
    /// <summary>
    /// Правило сканирования
    /// </summary>
    public class ScanRule
    {
        /// <summary>
        /// Назавние правила сканирования.
        /// </summary>
        public string RuleName { get; }
        /// <summary>
        /// Строка, которая соответствующая содержимому вредоносного файла.
        /// </summary>
        public string MalwareString { get; }
        /// <summary>
        /// Расширение сканируемых файлов.
        /// </summary>
        public string Extension { get; }

        /// <summary>
        /// Конструктор.
        /// </summary>
        /// <param name="ruleName">Назавние правила сканирования.</param>
        /// <param name="malwareString">Строка, которая соответствующая содержимому вредоносного файла.</param>
        /// <param name="extension">Расширение сканируемых файлов.</param>
        public ScanRule(string ruleName, string malwareString, string extension = "*")
        {
            RuleName = ruleName;
            MalwareString = malwareString;
            Extension = extension;
        }

        /// <summary>
        /// Проверка файла на соответствие расширению правила.
        /// </summary>
        /// <param name="fileName">Путь к файлу.</param>
        /// <returns>True, если расширение файла соответствует расширению правила</returns>
        public bool CheckFileExtension(string fileName)
        {
            if (Extension == "*") return true;
            return Path.GetExtension(fileName) == Extension;
        }
    }
}
